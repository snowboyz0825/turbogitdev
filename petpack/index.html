<!DOCTYPE HTML>
<html lang="en-US">

<head>
    <title>Name II Pet Pack</title>
    <style>
        body {
            background-color: #070e12;
        }

        .heading {
            font-size: 30pt;
        }

        .subheading {
            font-size: 24pt;
        }

        * {
            font-family: Arial, Helvetica, sans-serif;
            color: white
        }

        .imgdesc {
            text-align: center;
        }

        .item {
            width: 256px;
        }

        .maingrid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .modal {
            display: flex;
            position: fixed;
            inset: 0;
            justify-content: center;
            margin: auto;
            background-color: #05090c;
            border: 3.5px solid #020506;
            align-items: center;
            flex-direction: column;
            width: fit-content;
            height: fit-content;
            padding: 0 12px 12px 12px;
            border-radius: 12px;
        }

        .heading,
        .subheading {
            text-align: center;
            font-weight: normal;
        }

        .modal-title {
            font-size: 24px;
            font-weight: normal;
            margin-top: 6px;
        }

        .modal-desc {
            line-height: 1.6;
            align-self: flex-start;
            margin: 6px;
        }

        .modal-image {
            padding: 12px;
        }

        .modal-x {
            margin-top: 12px;
            padding-right: 12px;
            align-self: flex-end;
            font-size: 18pt;
        }

        .modal-content {
            display: flex;
            align-items: flex-start;
            margin-top: 0;
        }
    </style>
</head>

<body></body>
<script>
    var x = -1
    async function populate() {
        const temp = await fetch("allays.json");
        const references = await temp.json();

        references.forEach(item => {
            x++
            console.log(x)
            let longCategories = (references[x]).categories_long;
            let shortCategories = (references[x]).categories_short;
            let longsCategories = (references[x]).subcategories_long;
            let shortsCategories = (references[x]).subcategories_short
            let id = references[x].id
            let title = references[x].title
            //console.log(id)
            //console.log(longCategories)
            //console.log(shortCategories)

            let scx = -1
            shortCategories.forEach(item => {
                scx++
                //console.log("."+ shortCategories[scx])
                // if the category does not exist, we create one
                if (!document.querySelector("." + shortCategories[scx] + ".heading")) {

                    let newH2 = document.createElement('h1')
                    newH2.classList.add(shortCategories[scx], "heading")
                    newH2.innerHTML = longCategories[scx]
                    console.log(newH2.outerHTML)
                    document.body.appendChild(newH2)
                }
                if (shortsCategories[0]) {
                    // if there is a subcatregory
                    //we check if it exists
                    if (!document.querySelector("." + shortsCategories[scx] + ".subheading")) {
                        //if it doesn't we make one
                        let newH4 = document.createElement('h4')
                        newH4.classList.add(shortsCategories[scx], "subheading")
                        newH4.innerHTML = longsCategories[scx]
                        console.log(newH4.outerHTML)
                        document.body.appendChild(newH4)
                    }
                    //grid creation
                    var maingrid = document.querySelector("." + shortsCategories[scx] + ".maingrid")
                    //if there isn't a maingrid of the correct class
                    if (!maingrid) {
                        var maingrid = document.createElement('div')
                        maingrid.classList.add("maingrid", shortsCategories[scx])
                    }
                    //item creation
                    var newDiv = document.createElement('div')
                    newDiv.classList.add("item")
                    newDiv.dataset.img_src = `previews/${shortCategories[scx]}/${shortsCategories[scx]}/${id}.png`;
                    newDiv.innerHTML = `<img src="${newDiv.dataset.img_src}"><p class="imgdesc">${title}</p>`
                } else {
                    // if there isn't a subcategory
                    var maingrid = document.querySelector("." + shortCategories[scx] + ".maingrid")
                    //if there isn't a maingrid of the correct class
                    if (!maingrid) {
                        var maingrid = document.createElement('div')
                        maingrid.classList.add("maingrid", shortCategories[scx])
                    }
                    //item creation
                    var newDiv = document.createElement('div')
                    newDiv.dataset.id = id;
                    newDiv.classList.add("item")
                    newDiv.dataset.img_src = `previews/${shortCategories[scx]}/${id}.png`
                    newDiv.innerHTML = `<img src="${newDiv.dataset.img_src}"><p class="imgdesc">${title}</p>`
                }
                maingrid.appendChild(newDiv);
                document.body.appendChild(maingrid)
                //console.log(document.body.innerHTML)
                //console.log(document.head.innerHTML)
            }
            )
        })
        //    console.log(longCategories)
        //    console.log(shortCategories)
    };
    populate();
</script>

</html>